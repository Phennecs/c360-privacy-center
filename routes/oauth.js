'use strict';const a35_0x4cfd21=a35_0x24f6;(function(_0x3e2916,_0x292169){const _0x33f43b=a35_0x24f6,_0x1b9c05=_0x3e2916();while(!![]){try{const _0x1f56fc=-parseInt(_0x33f43b(0x1a4))/0x1*(-parseInt(_0x33f43b(0x1a7))/0x2)+-parseInt(_0x33f43b(0x1b3))/0x3*(parseInt(_0x33f43b(0x1c0))/0x4)+-parseInt(_0x33f43b(0x1d2))/0x5*(-parseInt(_0x33f43b(0x1c8))/0x6)+-parseInt(_0x33f43b(0x1cd))/0x7*(parseInt(_0x33f43b(0x1ae))/0x8)+parseInt(_0x33f43b(0x1bc))/0x9+parseInt(_0x33f43b(0x1c4))/0xa+-parseInt(_0x33f43b(0x1af))/0xb*(parseInt(_0x33f43b(0x1cf))/0xc);if(_0x1f56fc===_0x292169)break;else _0x1b9c05['push'](_0x1b9c05['shift']());}catch(_0xf6b2fd){_0x1b9c05['push'](_0x1b9c05['shift']());}}}(a35_0x1c7b,0xf1c4a));function a35_0x24f6(_0x312690,_0x1a08ef){const _0x1c7bc7=a35_0x1c7b();return a35_0x24f6=function(_0x24f6d8,_0xb23597){_0x24f6d8=_0x24f6d8-0x1a3;let _0x55fe3b=_0x1c7bc7[_0x24f6d8];return _0x55fe3b;},a35_0x24f6(_0x312690,_0x1a08ef);}const express=require('express');function a35_0x1c7b(){const _0x2fb8cb=['header','Error\x20attempting\x20to\x20authenticate\x20against\x20Salesforce\x20using\x20new\x20OAuth\x20credentials:\x20','110530AeiCmY','validateHerokuAuthHeader','37819572rrpGzU','accessToken','Heroku\x20auth\x20was\x20successful!\x20Proceeding...','9021805FjLrnI','post','236gJfiuj','OAuth2','Authorization','3246wEPVYY','update-cust-sf-oauth-vars','clientId','Connection','../controllers/worker/worker-utils/job-gateway','instanceUrl','../models/queue','8lcPOWx','11jWNQvu','Heroku\x20authentication\x20failed\x20on\x20/configure\x20request.','userInfo','jsforce','4659AVBcni','Error\x20setting\x20heroku\x20config\x20vars.\x20','Submitting\x20update-cust-sf-oauth-vars\x20job.\x20SF_INSTANCE_URL\x20=>\x20','json','Missing\x20auth\x20header\x20on\x20/configure\x20request.','/configure','authCode','log','Router','14276430LmcxQd','error','loginUrl','authorize','556bNkEsc','body','status','Unexpected\x20error:\x20','5999110yAqOuX','Access\x20token,\x20refresh\x20token,\x20instance\x20URL,\x20or\x20userInfo\x20object\x20were\x20not\x20obtained\x20from\x20OAuth\x20against\x20SF.\x20Something\x20is\x20wrong.','message','Unauthorized:\x20Missing\x20auth\x20header.','6eGeaCu','../settings','refreshToken'];a35_0x1c7b=function(){return _0x2fb8cb;};return a35_0x1c7b();}let router=express[a35_0x4cfd21(0x1bb)]();const herokuModel=require('../models/heroku'),jsforce=require(a35_0x4cfd21(0x1b2)),{sfApiVersion}=require(a35_0x4cfd21(0x1c9)),{handleJobSubmission}=require(a35_0x4cfd21(0x1ab)),{configQueue}=require(a35_0x4cfd21(0x1ad)),heroku=new herokuModel();router[a35_0x4cfd21(0x1a3)](a35_0x4cfd21(0x1b8),async function(_0x651afd,_0x59154){const _0x39f441=a35_0x4cfd21;console[_0x39f441(0x1ba)]('/oauth2/configure\x20received!');const _0x23c78f=_0x651afd[_0x39f441(0x1cb)](_0x39f441(0x1a6));if(!_0x23c78f)return console[_0x39f441(0x1bd)](_0x39f441(0x1b7)),_0x59154[_0x39f441(0x1c2)](0x191)[_0x39f441(0x1b6)]({'error':_0x39f441(0x1c7)});const _0x42dc82=await heroku[_0x39f441(0x1ce)](_0x23c78f);if(!_0x42dc82)return console[_0x39f441(0x1bd)](_0x39f441(0x1b0)),_0x59154[_0x39f441(0x1c2)](0x191)[_0x39f441(0x1b6)]({'error':'Unauthorized:\x20Heroku\x20authentication\x20failed.'});console[_0x39f441(0x1ba)](_0x39f441(0x1d1)),console[_0x39f441(0x1ba)](_0x651afd['body']);const _0x95051b=_0x651afd['body'][_0x39f441(0x1b9)],_0x2d9465=_0x651afd[_0x39f441(0x1c1)][_0x39f441(0x1a9)],_0x320ebd=_0x651afd['body'][_0x39f441(0x1be)],_0x2f3f31=_0x651afd[_0x39f441(0x1c1)]['redirectUri'],_0x413e3a=new jsforce[(_0x39f441(0x1a5))]({'loginUrl':_0x320ebd,'clientId':_0x2d9465,'redirectUri':_0x2f3f31}),_0x98eaa2=new jsforce[(_0x39f441(0x1aa))]({'oauth2':_0x413e3a,'version':sfApiVersion});try{_0x98eaa2[_0x39f441(0x1bf)](_0x95051b,async function(_0x1dbf30,_0xef0887){const _0x352503=_0x39f441;if(_0x1dbf30){console[_0x352503(0x1bd)](_0x1dbf30),_0x59154['status'](0x191)['json']({'received':!![],'authSuccessful':![],'configVarsSet':![],'error':_0x352503(0x1cc)+_0x1dbf30[_0x352503(0x1c6)]});return;}if(!_0x98eaa2[_0x352503(0x1d0)]||!_0x98eaa2[_0x352503(0x1ca)]||!_0x98eaa2[_0x352503(0x1ac)]||!_0x98eaa2[_0x352503(0x1b1)]){const _0x1cf1ce=_0x352503(0x1c5);console[_0x352503(0x1bd)](_0x1cf1ce),_0x59154[_0x352503(0x1c2)](0x1f4)[_0x352503(0x1b6)]({'received':!![],'authSuccessful':![],'configVarsSet':![],'error':_0x1cf1ce});return;}const _0x3a8b18={'SF_LOGIN_URL':_0x320ebd,'SF_CLIENT_ID':_0x2d9465,'SF_REDIRECT_URI':_0x2f3f31,'SF_ACCESS_TOKEN':_0x98eaa2[_0x352503(0x1d0)],'SF_REFRESH_TOKEN':_0x98eaa2['refreshToken'],'SF_INSTANCE_URL':_0x98eaa2[_0x352503(0x1ac)],'SF_LONG_ORG_ID':_0x98eaa2[_0x352503(0x1b1)]['organizationId'],'SF_USER_ID':_0x98eaa2[_0x352503(0x1b1)]['id']};try{console[_0x352503(0x1ba)](_0x352503(0x1b5)+_0x3a8b18['SF_INSTANCE_URL']),await handleJobSubmission({'queue':configQueue,'jobType':_0x352503(0x1a8),'jobData':{'tokenInfo':_0x3a8b18},'skipCounters':!![]}),_0x59154['status'](0xc8)[_0x352503(0x1b6)]({'received':!![],'authSuccessful':!![],'configVarsSet':!![]});return;}catch(_0x3cd7cf){const _0x21e8d4=_0x352503(0x1b4)+_0x3cd7cf[_0x352503(0x1c6)];console[_0x352503(0x1bd)](_0x21e8d4),_0x59154['status'](0x1f4)[_0x352503(0x1b6)]({'received':!![],'authSuccessful':!![],'configVarsSet':![],'error':_0x21e8d4});return;}});}catch(_0x24b297){console[_0x39f441(0x1bd)](_0x24b297),_0x59154[_0x39f441(0x1c2)](0x1f4)[_0x39f441(0x1b6)]({'received':!![],'authSuccessful':![],'configVarsSet':![],'error':_0x39f441(0x1c3)+_0x24b297['message']});return;}}),module['exports']=router;