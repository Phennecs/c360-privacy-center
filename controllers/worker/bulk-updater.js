const a3_0x364e75=a3_0x184e;(function(_0x54b3b0,_0x935df3){const _0x50a6bd=a3_0x184e,_0x1a16d4=_0x54b3b0();while(!![]){try{const _0x34c733=-parseInt(_0x50a6bd(0xe8))/0x1*(-parseInt(_0x50a6bd(0x98))/0x2)+-parseInt(_0x50a6bd(0xc5))/0x3+-parseInt(_0x50a6bd(0xb8))/0x4+parseInt(_0x50a6bd(0x7c))/0x5+parseInt(_0x50a6bd(0xbd))/0x6+parseInt(_0x50a6bd(0x97))/0x7+-parseInt(_0x50a6bd(0xd2))/0x8*(parseInt(_0x50a6bd(0x7a))/0x9);if(_0x34c733===_0x935df3)break;else _0x1a16d4['push'](_0x1a16d4['shift']());}catch(_0x10e509){_0x1a16d4['push'](_0x1a16d4['shift']());}}}(a3_0x16d5,0x72158));const sizeof=require('object-sizeof'),requiredParam=require(a3_0x364e75(0x96)),{skipSFDeletes}=require('../../settings'),{updateBulkCounters}=require(a3_0x364e75(0xbf)),{handleJobSubmission}=require('../worker/worker-utils/job-gateway'),{JobSubmissionError,BulkSingleRecordLimitsExceededError}=require(a3_0x364e75(0x9b)),Bulk2Job=require(a3_0x364e75(0x9f)),{insertBulkJob,insertBulkJobErrors,insertUniqBulkJobErrorsPerObj}=require('./worker-utils/bulk-jobs'),{acquireLock,releaseLock,LOCK_TYPES}=require(a3_0x364e75(0xd6)),{retrieveBulkBatchRecords,dropTmpBulkBatchTable,createTmpBulkBatchTable,loadTmpBulkBatchTable}=require(a3_0x364e75(0xa6));class BulkUpdater{constructor({job:job=requiredParam(a3_0x364e75(0x6f)),salesforce:salesforce=requiredParam(a3_0x364e75(0xca)),db:db=requiredParam('db'),modifyQueue:modifyQueue=requiredParam(a3_0x364e75(0xb7)),bulkQueue:bulkQueue=requiredParam(a3_0x364e75(0xcf)),upStateQueue:upStateQueue=requiredParam(a3_0x364e75(0x7f))}){const _0x4cdf58=a3_0x364e75;this[_0x4cdf58(0x9c)](job[_0x4cdf58(0x8f)]),this[_0x4cdf58(0x6f)]=job,this[_0x4cdf58(0xca)]=salesforce,this['db']=db,this[_0x4cdf58(0xb7)]=modifyQueue,this[_0x4cdf58(0x7f)]=upStateQueue,this[_0x4cdf58(0x8f)]=this[_0x4cdf58(0x6f)][_0x4cdf58(0x8f)],this['batchRecordCount']=this[_0x4cdf58(0x6f)]['data'][_0x4cdf58(0xbc)],this[_0x4cdf58(0xd7)]=this[_0x4cdf58(0x8f)][_0x4cdf58(0xd7)][_0x4cdf58(0xdd)]();if(this[_0x4cdf58(0x8f)][_0x4cdf58(0x95)])this[_0x4cdf58(0x76)]=_0x4cdf58(0xaa);else this[_0x4cdf58(0x8f)][_0x4cdf58(0x80)]?this[_0x4cdf58(0x76)]='(UNPR_RETRY)\x20':this[_0x4cdf58(0x76)]='';}[a3_0x364e75(0x9c)]({policyWrapper:policyWrapper=requiredParam(a3_0x364e75(0xc2)),executionId:executionId=requiredParam(a3_0x364e75(0xae)),policyName:policyName=requiredParam(a3_0x364e75(0x77)),objectName:objectName=requiredParam(a3_0x364e75(0xb9)),objectHash:objectHash=requiredParam('objectHash'),objectId:objectId=requiredParam('objectId'),recordRetention:recordRetention=requiredParam(a3_0x364e75(0xd7)),hardDelete:_0x526ffa,bulkBatchTableName:bulkBatchTableName=requiredParam(a3_0x364e75(0x8a)),batchRecordCount:batchRecordCount=requiredParam(a3_0x364e75(0xbc)),isRetry:_0x31147a,isUnproccRetry:_0x1b807b}){}async[a3_0x364e75(0xe7)](){const _0xfe84da=a3_0x364e75;try{const _0x48acd0=await retrieveBulkBatchRecords(this['data'][_0xfe84da(0x8a)]),_0x3712c8=this[_0xfe84da(0xb0)](_0x48acd0),_0x1d96e3=await this['submitBatchesToSF'](_0x3712c8);console['log'](this[_0xfe84da(0x76)]+'+++++\x20batchInfoList\x20(sliced\x202000)\x20on\x20object='+this['data'][_0xfe84da(0xb9)]+_0xfe84da(0xa2)+JSON[_0xfe84da(0xd1)](_0x1d96e3,undefined,0x2)['slice'](0x0,0x7d0)+'\x0a------------------'),await this[_0xfe84da(0x86)](_0x1d96e3);const _0x40ea68=await this[_0xfe84da(0xa0)](_0x1d96e3),_0x1d4a84=await this[_0xfe84da(0x6c)](_0x1d96e3),[_0x5137d6,_0x4030a6]=await this[_0xfe84da(0x8c)](_0x1d96e3),_0x38065b=await this['resubmitUnprocessedRecords'](_0x1d96e3),_0x23fc7c=await dropTmpBulkBatchTable(this[_0xfe84da(0x8f)][_0xfe84da(0x8a)]);return{'success':!![],'enableEndPhaseRetries':_0x4030a6};}catch(_0x58a6dc){return console[_0xfe84da(0xb5)](this[_0xfe84da(0x76)]+_0xfe84da(0xa1),_0x58a6dc),{'success':![],'error':_0x58a6dc};}}[a3_0x364e75(0x6e)]({bytes:_0x4c95c9,charCount:_0x3e7351,recordCount:_0x1f247b}){const _0x140748=a3_0x364e75;if(_0x4c95c9>0x5f5e100)return console[_0x140748(0x83)](this['logPrefix']+_0x140748(0xd3)+_0x4c95c9+_0x140748(0x8d)),!![];return![];}[a3_0x364e75(0x99)](_0x14746e){const _0x142f08=a3_0x364e75;return{'bytes':sizeof(_0x14746e),'charCount':JSON[_0x142f08(0xd1)](_0x14746e)[_0x142f08(0xe3)],'recordCount':Array['isArray'](_0x14746e)?_0x14746e['length']:0x1};}['getFullRecordStats'](_0x2b73ed){const _0x573736=a3_0x364e75;return{...this[_0x573736(0x99)](_0x2b73ed),'fieldCount':Object[_0x573736(0x71)](_0x2b73ed)[_0x573736(0xe3)],'maxFieldCharCount':Math[_0x573736(0xdf)](Object[_0x573736(0x79)](_0x2b73ed)[_0x573736(0xcb)](_0x427879=>JSON[_0x573736(0xd1)](_0x427879)[_0x573736(0xe3)]))};}['prettyBatchRecordStats'](_0x50246c){const _0x2ba92e=a3_0x364e75;return'recordCount:'+_0x50246c['recordCount']+_0x2ba92e(0x92)+(_0x50246c[_0x2ba92e(0xd5)]/0x400/0x400)[_0x2ba92e(0x73)](0x2)+'\x20\x20charCount:'+_0x50246c[_0x2ba92e(0xc7)];}[a3_0x364e75(0xea)](_0x436a75,_0xe0df01){const _0x17d85b=a3_0x364e75;return!this[_0x17d85b(0x6e)](this[_0x17d85b(0x90)](_0x436a75,_0xe0df01));}[a3_0x364e75(0x90)](_0x33a84b,_0x564c81){const _0x5ed0e6=a3_0x364e75;return{'bytes':_0x33a84b['bytes']+_0x564c81[_0x5ed0e6(0xd5)],'charCount':_0x33a84b[_0x5ed0e6(0xc7)]+_0x564c81[_0x5ed0e6(0xc7)],'recordCount':_0x33a84b['recordCount']+_0x564c81[_0x5ed0e6(0xe4)]};}[a3_0x364e75(0x7b)]({charCount:_0x5bb94c,fieldCount:_0x3c7071,maxFieldCharCount:_0x2947a7}){const _0xbfe02d=a3_0x364e75;if(_0x3c7071>0x1388)return console[_0xbfe02d(0x83)](this[_0xbfe02d(0x76)]+'fieldCount:\x20'+_0x3c7071+'\x20exceeded\x20limit\x20of\x205000.'),!![];if(_0x5bb94c>0x61698)return console['warn'](this[_0xbfe02d(0x76)]+_0xbfe02d(0x74)+_0x5bb94c+_0xbfe02d(0xe2)),!![];if(_0x2947a7>0x7c9c)return console['warn'](this['logPrefix']+_0xbfe02d(0xbe)+_0x2947a7+'\x20exceeded\x20limit\x20of\x2031900.'),!![];return![];}[a3_0x364e75(0xbb)](_0x27106f){const _0x3e5ff6=a3_0x364e75;return _0x27106f[_0x3e5ff6(0xb3)](_0x21887e=>!this[_0x3e5ff6(0x7b)](this[_0x3e5ff6(0xd0)](_0x21887e)));}['splitIntoBatches'](_0x1014cd){const _0x53feb1=a3_0x364e75,_0x139143=this[_0x53feb1(0x99)](_0x1014cd);console[_0x53feb1(0x8e)](this[_0x53feb1(0x76)]+_0x53feb1(0xd4)+this[_0x53feb1(0x8f)][_0x53feb1(0xb9)]+_0x53feb1(0xd9)+this[_0x53feb1(0x9d)](_0x139143));if(!this['allRecordsWithinRecordLimits'](_0x1014cd))throw new BulkSingleRecordLimitsExceededError(_0x139143);if(!this[_0x53feb1(0x6e)](_0x139143))return[_0x1014cd];else console['log'](this[_0x53feb1(0x76)]+'Splitting\x20up\x20records\x20for\x20'+this[_0x53feb1(0x8f)][_0x53feb1(0xb9)]);const _0x5cbce3=[],_0x9d35e1=()=>{return{'bytes':0x0,'charCount':0x0,'recordCount':0x0};};let _0x34be71=[],_0xb840c0=_0x9d35e1();while(_0x1014cd[_0x53feb1(0xe3)]){const _0x45544b=_0x1014cd[_0x53feb1(0x9e)](),_0x512311=this[_0x53feb1(0x99)](_0x45544b);if(!this[_0x53feb1(0xea)](_0xb840c0,_0x512311)){if(!_0x34be71[_0x53feb1(0xe3)])throw new BulkSingleRecordLimitsExceededError(_0x512311);_0x5cbce3[_0x53feb1(0xc1)](_0x34be71),_0x34be71=[],_0xb840c0=_0x9d35e1();}_0x34be71[_0x53feb1(0xc1)](_0x45544b),_0xb840c0=this[_0x53feb1(0x90)](_0xb840c0,_0x512311);}return _0x34be71[_0x53feb1(0xe3)]&&_0x5cbce3[_0x53feb1(0xc1)](_0x34be71),_0x5cbce3;}async['submitBatchesToSF'](_0x250cea){const _0x4cd151=a3_0x364e75,_0x34dc19=[];for(const _0x344cf7 of _0x250cea){const _0x344f19=await this[_0x4cd151(0x7d)](_0x344cf7);if(_0x344f19)_0x34dc19[_0x4cd151(0xc1)](_0x344f19);else console[_0x4cd151(0x83)](_0x4cd151(0xaf));}return _0x34dc19;}async[a3_0x364e75(0x7d)](_0x19e61d){const _0x3bad14=a3_0x364e75;if(!_0x19e61d||!_0x19e61d['length'])return;const _0xf43975=new Bulk2Job({'object':this[_0x3bad14(0x8f)]['objectName'],'operation':this['recordRetention']===_0x3bad14(0x70)?this[_0x3bad14(0x8f)][_0x3bad14(0x6d)]===!![]?_0x3bad14(0x6d):_0x3bad14(0x70):this[_0x3bad14(0xd7)]===_0x3bad14(0xab)?'upsert':null,'externalIdFieldName':this[_0x3bad14(0xd7)]===_0x3bad14(0x70)?null:this['recordRetention']===_0x3bad14(0xab)?'id':null});try{if(this[_0x3bad14(0x8f)][_0x3bad14(0x95)])await acquireLock(this['db'],LOCK_TYPES[_0x3bad14(0xb6)]);const _0x4de1f4=await _0xf43975[_0x3bad14(0xa7)](_0x19e61d);return _0x4de1f4;}finally{if(this[_0x3bad14(0x8f)][_0x3bad14(0x95)])await releaseLock(this['db'],LOCK_TYPES['SERIAL_BULK']);}}async['bulkDelete'](_0x18c1e5,_0x68fc30){const _0x1bb2c2=a3_0x364e75;return await this[_0x1bb2c2(0xca)][_0x1bb2c2(0xc9)](_0x18c1e5,_0x68fc30,_0x1bb2c2(0x70));}async[a3_0x364e75(0x78)](_0x187ca4,_0x168018){const _0x5d5fe5=a3_0x364e75;return await this[_0x5d5fe5(0xca)][_0x5d5fe5(0xc9)](_0x187ca4,_0x168018,_0x5d5fe5(0xa5));}async[a3_0x364e75(0x86)](_0x4eff71){const _0x2e4f76=a3_0x364e75;for(const _0x2ec9f8 of _0x4eff71){const {jobInfo:_0x2b0ec2,results:_0x4d9f17,coercedToStandardDelete:_0x18300d}=_0x2ec9f8;if(_0x18300d){const _0xdcf419=_0x2e4f76(0xa9),_0x3906d8='Bulk\x20job\x20creation\x20with\x20operation\x20hardDelete\x20failed\x20and\x20was\x20defaulted\x20to\x20standard\x20delete.',_0x3f3d5b=await insertUniqBulkJobErrorsPerObj({'executionId':this[_0x2e4f76(0x8f)]['executionId'],'sobject':this[_0x2e4f76(0x8f)][_0x2e4f76(0xb9)],'errorCode':_0xdcf419,'fullError':_0x3906d8});if(_0x3f3d5b[_0x2e4f76(0xa3)][_0x2e4f76(0xe3)]){let _0x275aac=_0x2e4f76(0xc3)+this[_0x2e4f76(0x8f)][_0x2e4f76(0xb9)]+'\x20encountered\x20a\x20new\x20error:\x20'+_0xdcf419+_0x2e4f76(0x85);console[_0x2e4f76(0x83)](this[_0x2e4f76(0x76)]+_0x275aac);const _0x5df20b=await this[_0x2e4f76(0xca)]['insertRunLog'](this[_0x2e4f76(0x8f)][_0x2e4f76(0xae)],this[_0x2e4f76(0x8f)][_0x2e4f76(0x77)],_0x2e4f76(0xdc),_0x2e4f76(0xe6),_0x275aac);}return;}}}async[a3_0x364e75(0xa0)](_0x34450e){const _0x3be7e0=a3_0x364e75;let _0x2d7271=0x0,_0x5b1b59=0x0,_0x5a97d6=0x0,_0x5e9f73=0x0;for(const _0x4ff637 of _0x34450e){const {jobInfo:_0x573aee,results:_0x34290a,coercedToStandardDelete:_0x2069e5,initialCount:_0x395b4b,missingFromResultSfids:_0x1d8c5e}=_0x4ff637;_0x34290a&&(_0x2d7271+=_0x395b4b,this['data']['isRetry']?(_0x5b1b59-=_0x34290a['successfulResults'][_0x3be7e0(0xe3)],_0x5a97d6+=_0x34290a[_0x3be7e0(0xda)][_0x3be7e0(0xe3)]):(_0x5b1b59+=_0x34290a[_0x3be7e0(0x8b)][_0x3be7e0(0xe3)]+_0x1d8c5e[_0x3be7e0(0xe3)],_0x5a97d6+=_0x34290a[_0x3be7e0(0xda)][_0x3be7e0(0xe3)],_0x5e9f73+=_0x34290a[_0x3be7e0(0x8b)][_0x3be7e0(0xe3)]+_0x34290a[_0x3be7e0(0xda)][_0x3be7e0(0xe3)]+_0x1d8c5e[_0x3be7e0(0xe3)]));}const _0x475e71=await updateBulkCounters(this[_0x3be7e0(0x8f)][_0x3be7e0(0xae)],this['data'][_0x3be7e0(0xd7)],this[_0x3be7e0(0x8f)][_0x3be7e0(0xe1)],_0x2d7271,_0x5a97d6,_0x5b1b59,_0x5e9f73);return _0x475e71;}async[a3_0x364e75(0x6c)](_0x43182b){const _0x135888=a3_0x364e75;for(const _0x1767e8 of _0x43182b){const {jobInfo:_0x354e14,results:_0x6326c2,initialCount:_0x480a23,missingFromResultSfids:_0x2f0d40,timedOut:_0x56334f,startTs:_0x94f3da,endTs:_0x4856fb}=_0x1767e8,_0x4d348a=_0x94f3da&&_0x4856fb?_0x4856fb[_0x135888(0xac)]()-_0x94f3da[_0x135888(0xac)]():null,_0x2a5a6a=await insertBulkJob({'jobId':_0x354e14['id'],'executionId':this[_0x135888(0x8f)][_0x135888(0xae)],'sobject':this[_0x135888(0x8f)][_0x135888(0xb9)],'operation':_0x354e14['operation'],'concurrencyMode':_0x354e14[_0x135888(0x7e)],'jobInfo':_0x354e14,'finalState':_0x354e14[_0x135888(0xb2)],'initialCount':_0x480a23,'totalCount':_0x6326c2['successfulResults']['length']+_0x6326c2[_0x135888(0x8b)][_0x135888(0xe3)]+_0x6326c2['unprocessedRecords']['length']+_0x2f0d40[_0x135888(0xe3)],'successfulCount':_0x6326c2[_0x135888(0xda)][_0x135888(0xe3)],'failedCount':_0x6326c2[_0x135888(0x8b)]['length']+_0x2f0d40[_0x135888(0xe3)],'unprocessedCount':_0x6326c2[_0x135888(0xcc)]['length'],'timedOut':!!_0x56334f,'isRetry':this['data']['isRetry'],'startTs':_0x94f3da,'endTs':_0x4856fb,'durationMs':_0x4d348a});if(_0x6326c2[_0x135888(0x8b)]['length']||_0x2f0d40['length']){const _0x39f999={},_0x121902=[];_0x6326c2[_0x135888(0x8b)][_0x135888(0xdb)](_0x1d2d46=>{const _0x10d950=_0x135888,_0x271c96=_0x1d2d46['sf__Error'];let _0x49a48d=_0x1d2d46[_0x10d950(0xe9)];_0x49a48d==''||!_0x49a48d?_0x49a48d='unknown':_0x49a48d=_0x1d2d46[_0x10d950(0xe9)][_0x10d950(0xa4)](/:.*/,''),!(_0x49a48d in _0x39f999)&&(_0x39f999[_0x49a48d]=0x0),_0x39f999[_0x49a48d]++,!_0x121902['some'](_0x5374b9=>_0x5374b9[_0x10d950(0x81)]==_0x271c96)&&_0x121902['push']({'errorCode':_0x49a48d,'fullError':_0x271c96});});_0x2f0d40[_0x135888(0xe3)]&&(_0x39f999[_0x135888(0x72)]=_0x2f0d40[_0x135888(0xe3)],_0x121902['push']({'errorCode':'MISSING_FROM_RESULTS','fullError':'MISSING_FROM_RESULTS:\x20One\x20or\x20more\x20records\x20were\x20missing\x20from\x20the\x20result\x20list\x20returned\x20by\x20the\x20bulk\x20API.\x20This\x20typically\x20happens\x20on\x20some\x20aborted\x20jobs\x20after\x20max\x20timeout\x20is\x20reached.'}));for(const {errorCode:_0x5417e8,fullError:_0x11a6ad}of _0x121902){const _0x3be343=await insertUniqBulkJobErrorsPerObj({'executionId':this['data'][_0x135888(0xae)],'sobject':this['data']['objectName'],'errorCode':_0x5417e8,'fullError':_0x11a6ad});if(_0x3be343[_0x135888(0xa3)][_0x135888(0xe3)]){let _0x556d5e=_0x135888(0xc3)+this[_0x135888(0x8f)][_0x135888(0xb9)]+_0x135888(0xde)+_0x5417e8+_0x135888(0xe0)+_0x11a6ad;console['warn'](this['logPrefix']+_0x556d5e);_0x5417e8=='MISSING_FROM_RESULTS'?_0x556d5e+=_0x135888(0x88):_0x556d5e+=_0x135888(0x89);const _0x57c609=await this[_0x135888(0xca)][_0x135888(0x84)](this[_0x135888(0x8f)][_0x135888(0xae)],this[_0x135888(0x8f)]['policyName'],_0x135888(0xdc),_0x135888(0xe6),_0x556d5e);}}for(const [_0x349872,_0x313dda]of Object[_0x135888(0xba)](_0x39f999)){const _0x44c119=await insertBulkJobErrors({'jobId':_0x354e14['id'],'errorCode':_0x349872,'errorCount':_0x313dda});}}}}async[a3_0x364e75(0x8c)](_0x51273a){const _0xb3aa21=a3_0x364e75;let _0x1db551=![];const _0x5df689=[];for(const _0x3653e3 of _0x51273a){const {jobInfo:_0x2f517d,results:_0xe689a,missingFromResultSfids:_0x527e96,timedOut:_0x121fb6}=_0x3653e3;if(_0xe689a){let _0x1e5b49=![];const _0x33c811=_0xe689a[_0xb3aa21(0xda)]['map'](_0x158629=>{const _0x4d4180=_0xb3aa21;!_0x158629['sf__Id']&&!_0x158629['id']&&!_0x1e5b49&&(console[_0x4d4180(0xb5)](this['logPrefix']+_0x4d4180(0xb4)),console[_0x4d4180(0x8e)](_0x4d4180(0xc0),JSON[_0x4d4180(0xd1)](_0x158629)),_0x1e5b49=!![]);const _0x28d103=_0x158629[_0x4d4180(0xb1)]?_0x158629['sf__Id']:_0x158629['id']?_0x158629['id']:null,_0x1350de='s';return[_0x28d103,_0x1350de];});_0x1e5b49=![];const _0x3725fc=_0xe689a[_0xb3aa21(0x8b)][_0xb3aa21(0xcb)](_0x57c285=>{const _0x4137cc=_0xb3aa21;!_0x57c285['sf__Id']&&!_0x57c285['id']&&!_0x1e5b49&&(console[_0x4137cc(0xb5)](this[_0x4137cc(0x76)]+_0x4137cc(0x6b)),console[_0x4137cc(0x8e)]('failedRow:',JSON[_0x4137cc(0xd1)](_0x57c285)),_0x1e5b49=!![]);const _0x48efcf=_0x57c285[_0x4137cc(0xb1)]?_0x57c285[_0x4137cc(0xb1)]:_0x57c285['id']?_0x57c285['id']:null;let _0x49654c=_0x57c285[_0x4137cc(0xe9)];!_0x49654c?_0x49654c=_0x4137cc(0x75):(_0x49654c=_0x57c285['sf__Error'][_0x4137cc(0xa4)](/:.*/,''),_0x49654c==''&&(_0x49654c=_0x4137cc(0x75)));let _0x3d2f8b;if(this[_0x4137cc(0x8f)][_0x4137cc(0x95)])_0x3d2f8b='f';else{if([_0x4137cc(0x82)][_0x4137cc(0xc6)](_0x49654c))_0x3d2f8b='l',_0x1db551=!![];else[_0x4137cc(0xc8)][_0x4137cc(0xc6)](_0x49654c)?_0x3d2f8b='x':_0x3d2f8b='e';}return[_0x48efcf,_0x3d2f8b];}),_0x3ca65f=_0x527e96[_0xb3aa21(0xcb)](_0x95d92a=>{return[_0x95d92a,'m'];});if(!this[_0xb3aa21(0x8f)][_0xb3aa21(0x95)]&&process['env'][_0xb3aa21(0x87)]&&this['job']['id']%0x2==0x0){const _0x4abb50=_0x33c811['length']<0xf?_0x33c811[_0xb3aa21(0xe3)]:0xf;for(let _0x27a6d4=0x1;_0x27a6d4<=_0x4abb50;_0x27a6d4++){const _0xc9188=_0x33c811[_0xb3aa21(0x9e)]();_0xc9188[0x1]='l',_0x3725fc[_0xb3aa21(0xc1)](_0xc9188);}_0x1db551=!![];}_0x5df689[_0xb3aa21(0xc1)](..._0x33c811,..._0x3725fc,..._0x3ca65f);}}if(_0x5df689[_0xb3aa21(0xe3)])try{console[_0xb3aa21(0x8e)](this[_0xb3aa21(0x76)]+_0xb3aa21(0x91)+this[_0xb3aa21(0x8f)]['objectName']+'\x20with\x20'+_0x5df689[_0xb3aa21(0xe3)]+_0xb3aa21(0xce));const _0x16f68e=await handleJobSubmission({'queue':this[_0xb3aa21(0x7f)],'jobType':_0xb3aa21(0xd8),'jobData':{'executionId':this[_0xb3aa21(0x8f)][_0xb3aa21(0xae)],'policyName':this[_0xb3aa21(0x8f)][_0xb3aa21(0x77)],'objectName':this['data'][_0xb3aa21(0xb9)],'subIdStateArr':_0x5df689},'enableRetries':!![],'noJobName':!![]});return[_0x16f68e,_0x1db551];}catch(_0x27bb1e){throw new JobSubmissionError(_0xb3aa21(0xa8)+_0x27bb1e[_0xb3aa21(0xe5)]);}else return[null,_0x1db551];}async[a3_0x364e75(0xcd)](_0x4643c1){const _0x28a0ad=a3_0x364e75,_0x5acdd4=[];for(const _0x80485c of _0x4643c1){const {jobInfo:_0x3b98c1,results:_0x59583b}=_0x80485c;_0x59583b&&_0x59583b[_0x28a0ad(0xcc)][_0x28a0ad(0xe3)]&&_0x5acdd4['push'](..._0x59583b['unprocessedRecords']);}if(_0x5acdd4[_0x28a0ad(0xe3)]){const _0xb0df67=await createTmpBulkBatchTable(),_0xd49278=await loadTmpBulkBatchTable(_0xb0df67,_0x5acdd4),_0x4e065b=await this[_0x28a0ad(0xc4)](_0xb0df67,_0x5acdd4[_0x28a0ad(0xe3)]);return _0x4e065b;}else return null;}async['submitBulkUpdater'](_0x3f6ff8,_0x313e05){const _0x29a1e4=a3_0x364e75;console[_0x29a1e4(0x8e)](this[_0x29a1e4(0x76)]+_0x29a1e4(0x9a)+this[_0x29a1e4(0x8f)][_0x29a1e4(0xb9)]+_0x29a1e4(0x94)+_0x313e05+_0x29a1e4(0xad));const _0x3dd700=await handleJobSubmission({'queue':this['bulkQueue'],'jobType':_0x29a1e4(0x93),'jobData':{...this[_0x29a1e4(0x8f)],'bulkBatchTableName':_0x3f6ff8,'batchRecordCount':_0x313e05,'isUnproccRetry':!![]},'enableRetries':![],'noJobName':!![]});return _0x3dd700;}}module['exports']=BulkUpdater;function a3_0x184e(_0xb85142,_0x4dd873){const _0x16d54f=a3_0x16d5();return a3_0x184e=function(_0x184ed2,_0x514018){_0x184ed2=_0x184ed2-0x6b;let _0x2243cc=_0x16d54f[_0x184ed2];return _0x2243cc;},a3_0x184e(_0xb85142,_0x4dd873);}function a3_0x16d5(){const _0x437561=['getFullRecordStats','stringify','248pNJTnk','Total\x20batch\x20bytes:\x20','Records\x20batch\x20for\x20object=','bytes','./worker-utils/lock-utils','recordRetention','cache-submitted-updater','\x20stats\x20pre-split:\x20','successfulResults','forEach','Error','toLowerCase','\x20encountered\x20a\x20new\x20error:\x20','max','.\x20Further\x20instances\x20of\x20this\x20error\x20will\x20not\x20be\x20logged\x20on\x20this\x20run.\x20Full\x20error:\x20','objectId','\x20exceeded\x20limit\x20of\x20399000.','length','recordCount','message','Bulk\x20Operation','run','1433vhgeOm','sf__Error','nextRecordFitsInBatch','One\x20or\x20more\x20batch\x20result\x20failed\x20rows\x20did\x20not\x20have\x20an\x20sf__Id\x20or\x20id\x20field!\x20This\x20should\x20never\x20happen.','insertJobDetailsToDb','hardDelete','batchStatsExceedLimits','job','delete','keys','MISSING_FROM_RESULTS','toFixed','charCount:\x20','unknown','logPrefix','policyName','bulkUpdate','values','27819pqDvSM','singleRecordExceedsLimits','4519285kCDjxm','submitBatchToSF','concurrencyMode','upStateQueue','isUnproccRetry','fullError','UNABLE_TO_LOCK_ROW','warn','insertRunLog','.\x20Further\x20instances\x20of\x20this\x20error\x20will\x20not\x20be\x20logged\x20on\x20this\x20run.\x20Full\x20error:\x20Initial\x20attempt\x20to\x20create\x20a\x20bulk\x20job\x20with\x20operation\x20hardDelete\x20has\x20failed\x20and\x20has\x20been\x20defaulted\x20to\x20standard\x20delete.\x20This\x20likely\x20means\x20the\x20Hard\x20Delete\x20administrative\x20permission\x20is\x20not\x20enabled\x20for\x20the\x20PC\x20SF\x20user.\x20We\x20recommend\x20creating\x20a\x20new\x20permission\x20set\x20to\x20solve\x20this.\x20More\x20info\x20can\x20be\x20found\x20here:\x20https://help.salesforce.com/articleView?id=000328731&type=1&mode=1','insertSpecialUniqErrors','FORCE_BULK_LOCKS','\x20These\x20records\x20will\x20be\x20processed\x20on\x20the\x20next\x20policy\x20execution.','\x20More\x20info\x20on\x20these\x20error\x20codes\x20can\x20be\x20found\x20here:\x20https://developer.salesforce.com/docs/atlas.en-us.228.0.api.meta/api/sforce_api_calls_concepts_core_data_objects.htm','bulkBatchTableName','failedResults','submitSubUpdaterJob','\x20exceeded\x20limit\x20of\x20100000000\x20(100\x20MB)','log','data','addBatchStats','Submitting\x20cache-submitted-updater\x20job\x20for\x20','\x20\x20megabytes:','bulk-updater','\x20with\x20','isRetry','../../utils/required-param','4613315tsWYGM','136pFeNIY','getRecordOrBatchStats','Re-submitting\x20unprocessed\x20records\x20to\x20bulk-updater\x20job\x20for\x20objectName:\x20','../../errors','validateJobData','prettyBatchRecordStats','shift','../../models/salesforce/bulk2-job','updateBulkCounters','Error\x20submitting\x20batch\x20operation\x20to\x20Salesforce!','\x20+++++\x0a','rows','replace','update','./worker-utils/bulk-batch-tmp-table','runFullBulkJobFlow','ERROR:\x20Could\x20not\x20submit\x20cache-submitted-updater\x20job\x20to\x20modify\x20queue.\x20','COERCED_TO_STANDARD_DELETE','(RETRY)\x20','transform','getTime','\x20records...','executionId','No\x20batchInfo\x20returned\x20from\x20submitBatchToSF()!','splitIntoBatches','sf__Id','state','every','One\x20or\x20more\x20batch\x20successful\x20result\x20rows\x20did\x20not\x20have\x20a\x20sf__Id\x20or\x20id\x20field!\x20This\x20should\x20never\x20happen.','error','SERIAL_BULK','modifyQueue','2378884vDqAVj','objectName','entries','allRecordsWithinRecordLimits','batchRecordCount','2445420EmAXOg','maxFieldCharCount:\x20','./worker-utils/bulk-counters','successRow:','push','policyWrapper','Bulk\x20data\x20load\x20for\x20object:\x20','submitBulkUpdater','2730258EiOKPv','includes','charCount','ENTITY_IS_DELETED','bulkOperation','salesforce','map','unprocessedRecords','resubmitUnprocessedRecords','\x20records.','bulkQueue'];a3_0x16d5=function(){return _0x437561;};return a3_0x16d5();}